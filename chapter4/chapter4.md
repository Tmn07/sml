## 第四章

- 朴素贝叶斯法

### 概率论
- 复习一波概率论姿势

联合概率：$P(A,B)/P(AB)/P(A∩B)$ 就是A，B同时发生的概率

条件概率：$P(A|B)=\frac{P(AB)}{P(B)}$
乘法公式：$P(AB)=P(B)P(A|B)$
全概率公式：$P(A)=\sum_iP(B_i)P(A|B_i)$
楼上可以推出楼下
贝叶斯公式：
$$P(B_i|A)=\frac{P(B_i)P(A|B_i)}{\sum_iP(B_i)P(A|B_i)}$$

### 假设
（我们的目的是：已知变量x，求其在Y($y_1,y_2,....y_n$)分类下的概率 即$P(y_j|x)$）
朴素贝叶斯法做出了一个假设：
例如随机变量 $x = (x^{(0)},x^{(1)},x^{(i)})$ ，一个i维的向量，假设其$ x^{(0)},x^{(1)},x^{(i)}$之间相互独立，木有关联
则有
$$ P(x|y) = P(x^{(0)},x^{(1)},x^{(i)}|y) = \prod_iP(x^{(i)}|y) $$

$$$$$$
然后利用贝叶斯公式，准备计算后验概率
$$ P(Y=y_j|x)=\frac{P(Y=y_j)P(x|y_j)}{\sum_{i=1}^nP(Y=y_i)P(x|y_i)} $$

### 计算过程
- 求先验概率
$$ P(Y=y_j)=\frac{y_j出现次数}N$$

- 遍历x所有情况，求条件概率/似然概率 ($a_{ij}$ 为x的第i维特征的第j种可能的取值)
$$ P(x^{(i)}=a_{ij}|Y=y_j) = \frac{x^{(i)}=a_{ij}且Y=y_j 出现的次数}{Y=y_j出现的次数}  =\frac{P(xy)}{P(y)}$$

- 给定$x = (n,m)$求后验概率（利用贝叶斯公式
$$ P(Y=y_j|x) = \frac{P(Y=y_j)P(x^{(1)}=n|Y=y_j)P(x^{(2)}=m|Y=y_j)}{分母都一样，省略}  $$
- 计算分类的情况，取最大的即可

公式写的有点混乱，一开始觉得这样写比较简单，，结果到最后不得不那样写。。。

### 贝叶斯估计
- 存在训练集中没有的情况，这该条件下似然概率为0，严重影响计算
- $K为y_i的种数，S_i为a_i的种数$
$$ P(Y=y_j)=\frac{y_j出现次数+r}{N+K*r}$$
$$ P(x^{(i)}=a_{ij}|Y=y_j) = \frac{x^{(i)}=a_{ij}且Y=y_j 出现的次数 + r}{Y=y_j出现的次数 + r*S_i}$$